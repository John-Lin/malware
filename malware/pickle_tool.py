import os
import cPickle as pickle
import simplejson as json


def update_pickle(new_cache):
    # print('Updated pickle')
    pickle.dump(new_cache, open('cache.pkl', 'wb'), 2)


def check_pickle():
    # print('Checking in pickle')
    if not os.path.isfile('cache.pkl'):
        malicious_url = {}
        pickle.dump(malicious_url, open('cache.pkl', 'wb'), 2)

    cache = pickle.load(open('cache.pkl', 'rb'))
    return cache


def update_json(data):
    with open("url_cache.json", "wb") as fp:
        try:
            json.dump(data, fp)
        except:
            print "UnicodeDecodeError: 'utf8' codec can't decode byte 0xb8"


def check_json():
    if not os.path.isfile('url_cache.json'):
        init = {}
        with open("url_cache.json", "wb") as fp:
            json.dump(init, fp)

    with open("url_cache.json", "rb") as fp:
        # cache = json.load(fp)
        cache = json.load(fp, "ISO-8859-1")
    return cache
